<div class="h-screen w-full flex flex-col md:flex-row">

  <div class="hidden md:block md:w-1/2 xl:w-2/3">
    <img
      src="/bg_login.png"
      alt="Background Recuperação de senha"
      class="object-cover h-full w-full"
    >
  </div>

  <div class="p-2 lg:p-4 h-full w-full md:w-1/2 xl:w-1/3 flex flex-col items-center justify-center relative">

    <a
        routerLink="/login"
        class="absolute top-6 left-6 flex items-center text-gray-500 hover:text-gray-900 transition-colors cursor-pointer"
    >
        <mat-icon class="mr-1 text-sm leading-none">arrow_back</mat-icon>
        <span class="text-sm font-medium">Voltar</span>
    </a>

    <app-logo cssClass="size-40"></app-logo>

    <section class="w-full flex flex-col items-center justify-center p-4">

        <div class="flex flex-col gap-2 items-center py-4">
            <h1 class="text-2xl font-bold">
                Alterar senha
            </h1>
            <p class="text-gray-500 text-center">
                Crie uma nova senha segura.
            </p>
        </div>

        @if (!tokenValid()) {
          <div class="flex flex-col items-center justify-center text-center">
            <mat-icon
              class="text-red-500 mb-4"
              style="font-size: 48px; width: 48px; height: 48px"
            >
              error
            </mat-icon>
            <h2 class="text-xl font-bold text-gray-900 mb-2">
              Link inválido ou expirado
            </h2>
            <p class="text-gray-500 mb-6 text-sm">
              O link para resetar sua senha expirou. Solicite um novo link.
            </p>
            <a
              routerLink="/esqueci-senha"
              class="w-full rounded-full bg-[#C81E71] py-3 px-4 text-base font-bold text-white shadow-sm transition-all hover:bg-[#A9125B] hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#C81E71] focus:ring-offset-2 cursor-pointer text-center"
            >
              Solicitar novo link
            </a>
          </div>
        } @else {
          <form
            [formGroup]="form"
            (ngSubmit)="onSubmit()"
            class="flex flex-col gap-2 w-full"
          >
            <app-form-input
                formControlName="password"
                type="password"
                label="Nova Senha*"
                placeholder="Digite a nova senha"
                [errorMessage]="handlePasswordErrorMessage()"
            />
            
            <app-form-input
                formControlName="confirmPassword"
                type="password"
                label="Confirmar Senha*"
                placeholder="Confirme a nova senha"
                [errorMessage]="handleConfirmPasswordErrorMessage()"
            />

            <button
                class="w-full"
                matButton="filled"
                type="submit"
                [disabled]="loadingRequest() || !form.valid"
            >
                <span class="text-lg font-semibold">
                    @if(loadingRequest()) {
                        <span>Salvando...</span>
                    } @else {
                        <span>Salvar senha</span>
                    }
                </span>
            </button>
          </form>
        }

    </section>

</div>